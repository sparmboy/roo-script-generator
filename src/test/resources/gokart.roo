##########################
# Project Initialisation #
##########################

# Create the project
project --topLevelPackage com.coup.gokart

# Setup persistence
jpa setup --provider HIBERNATE --database HYPERSONIC_PERSISTENT

#######################
# Create the entities #
#######################

# Driver
entity jpa --class com.coup.gokart.Driver --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.DriverRepository --entity com.coup.gokart.Driver

# League
entity jpa --class com.coup.gokart.League --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.LeagueRepository --entity com.coup.gokart.League

# Race
entity jpa --class com.coup.gokart.Race --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.RaceRepository --entity com.coup.gokart.Race

# RaceVenue
entity jpa --class com.coup.gokart.RaceVenue --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.RaceVenueRepository --entity com.coup.gokart.RaceVenue

# Circuit
entity jpa --class com.coup.gokart.Circuit --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.CircuitRepository --entity com.coup.gokart.Circuit

# LapTime
entity jpa --class com.coup.gokart.LapTime --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.LapTimeRepository --entity com.coup.gokart.LapTime

# Kart
entity jpa --class com.coup.gokart.Kart --activeRecord false --testAutomatically
repository jpa --interface com.coup.gokart.KartRepository --entity com.coup.gokart.Kart

########################
# Entity Relationships #
########################
field number --type int --fieldName number1 --class com.coup.gokart.LapTime --notNull 
field string --fieldName race --class com.coup.gokart.LapTime --notNull 
field string --fieldName driver --class com.coup.gokart.LapTime --notNull 
field date --type java.util.Calendar --fieldName time1 --class com.coup.gokart.LapTime --notNull 
field string --fieldName circuit --class com.coup.gokart.LapTime --notNull 

# Driver to string [One to Many]
field set --fieldName league --type com.coup.gokart.string --class com.coup.gokart.Driver --cardinality ONE_TO_MANY
field string --fieldName firstName --class com.coup.gokart.Driver --notNull 
field string --fieldName lastName --class com.coup.gokart.Driver --notNull 
field string --fieldName nickname --class com.coup.gokart.Driver 
field number --type int --fieldName weight --class com.coup.gokart.Driver 

# Driver to string [One to Many]
field set --fieldName lapTimes --type com.coup.gokart.string --class com.coup.gokart.Driver --cardinality ONE_TO_MANY

# Driver to string [One to Many]
field set --fieldName races --type com.coup.gokart.string --class com.coup.gokart.Driver --cardinality ONE_TO_MANY
field string --fieldName kart --class com.coup.gokart.Driver --notNull 
field number --type int --fieldName circuitId --class com.coup.gokart.Circuit --unique --notNull 
field string --fieldName name --class com.coup.gokart.Circuit --notNull 
field string --fieldName raceVenue --class com.coup.gokart.Circuit --notNull 
field number --type double --fieldName length --class com.coup.gokart.Circuit --notNull 

# Circuit to string [One to Many]
field set --fieldName lapTimes --type com.coup.gokart.string --class com.coup.gokart.Circuit --cardinality ONE_TO_MANY
field number --type int --fieldName engineSizeCC --class com.coup.gokart.Kart 
field string --fieldName name --class com.coup.gokart.League --notNull 

# League to string [One to Many]
field set --fieldName drivers --type com.coup.gokart.string --class com.coup.gokart.League --cardinality ONE_TO_MANY

# League to string [One to Many]
field set --fieldName races --type com.coup.gokart.string --class com.coup.gokart.League --cardinality ONE_TO_MANY

# RaceVenue to string [One to Many]
field set --fieldName circuit --type com.coup.gokart.string --class com.coup.gokart.RaceVenue --cardinality ONE_TO_MANY
field string --fieldName circuit --class com.coup.gokart.Race --notNull 

# Race to string [One to Many]
field set --fieldName drivers --type com.coup.gokart.string --class com.coup.gokart.Race --cardinality ONE_TO_MANY

########################
# Web Tier	       #
########################
json all
web mvc json setup
web mvc json all --package com.coup.gokart

########################
# Add Selenium Tests   #
########################
selenium test --controller com.coup.gokart.DriverController
selenium test --controller com.coup.gokart.LeagueController
selenium test --controller com.coup.gokart.RaceController
selenium test --controller com.coup.gokart.RaceVenueController
selenium test --controller com.coup.gokart.CircuitController
selenium test --controller com.coup.gokart.LapTimeController
selenium test --controller com.coup.gokart.KartController
